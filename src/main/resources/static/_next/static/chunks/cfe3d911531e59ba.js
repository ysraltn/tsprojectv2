(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";e.s(["Card",()=>a,"CardContent",()=>l,"CardDescription",()=>n,"CardHeader",()=>i,"CardTitle",()=>s]);var t=e.i(43476),r=e.i(75157);function a(e){let{className:a,...i}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...i})}function i(e){let{className:a,...i}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...i})}function s(e){let{className:a,...i}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",a),...i})}function n(e){let{className:a,...i}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",a),...i})}function l(e){let{className:a,...i}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",a),...i})}},48425,e=>{"use strict";e.s(["Primitive",()=>s,"dispatchDiscreteCustomEvent",()=>n]);var t=e.i(71645),r=e.i(74080),a=e.i(91918),i=e.i(43476),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let s=(0,a.createSlot)("Primitive.".concat(r)),n=t.forwardRef((e,t)=>{let{asChild:a,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(a?s:r,{...n,ref:t})});return n.displayName="Primitive.".concat(r),{...e,[r]:n}},{});function n(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}},75254,e=>{"use strict";e.s(["default",()=>n],75254);var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,t.forwardRef)((e,r)=>{let{color:s="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:o="",children:c,iconNode:u,...m}=e;return(0,t.createElement)("svg",{ref:r,...i,width:n,height:n,stroke:s,strokeWidth:d?24*Number(l)/Number(n):l,className:a("lucide",o),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[r,a]=e;return(0,t.createElement)(r,a)}),...Array.isArray(c)?c:[c]])}),n=(e,i)=>{let n=(0,t.forwardRef)((n,l)=>{let{className:d,...o}=n;return(0,t.createElement)(s,{ref:l,iconNode:i,className:a("lucide-".concat(r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),d),...o})});return n.displayName=r(e),n}},87486,e=>{"use strict";e.s(["Badge",()=>n]);var t=e.i(43476),r=e.i(91918),a=e.i(25913),i=e.i(75157);let s=(0,a.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:a,variant:n,asChild:l=!1,...d}=e,o=l?r.Slot:"span";return(0,t.jsx)(o,{"data-slot":"badge",className:(0,i.cn)(s({variant:n}),a),...d})}},70925,e=>{"use strict";e.s(["default",()=>u]);var t=e.i(43476),r=e.i(71645),a=e.i(18566),i=e.i(9165),s=e.i(15288),n=e.i(67489),l=e.i(19455),d=e.i(87486),o=e.i(46696);function c(){let e=(0,a.useSearchParams)().get("institutionId"),[c,u]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[g,p]=(0,r.useState)(e?Number(e):null),[h,v]=(0,r.useState)(null),[f,b]=(0,r.useState)(null),[j,y]=(0,r.useState)({}),[S,N]=(0,r.useState)({}),[w,C]=(0,r.useState)([]),[A,B]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{try{B(!0);let[e,t]=await Promise.all([i.institutionApi.getAll({page:0,size:100,sort:"name"}),i.consumableApi.getAll()]),r=Array.isArray(e)?e:Array.isArray(null==e?void 0:e.content)?e.content:[];if(u(r.map(e=>({id:e.id,name:e.name}))),x(t),r.length){let e=await i.institutionConsumablesApi.getBulkByInstitutionIds(r.map(e=>e.id));y(e||{});let t={};for(let e of r)try{let r=await i.institutionConsumableTypeApi.getByInstitution(e.id);t[String(e.id)]=r}catch(r){t[String(e.id)]=[]}N(t)}}catch(e){console.error(e),o.toast.error("Kurumlar veya sarf malzemeleri yüklenemedi")}finally{B(!1)}})()},[]);let k=(0,r.useMemo)(()=>g&&j[String(g)]||[],[j,g]),T=(0,r.useMemo)(()=>g&&S[String(g)]||[],[S,g]),z=async()=>{if(!g||!f)return void o.toast.error("Kurum ve alt tip seçin");try{await i.institutionConsumableTypeApi.create({institutionId:g,consumableTypeId:f}),o.toast.success("Alt tip bağlandı");try{let e=await i.institutionConsumableTypeApi.getByInstitution(g);N(t=>({...t,[String(g)]:e}))}catch(e){console.error("Failed to refresh subtypes:",e)}}catch(r){var e,t;console.error(r),o.toast.error((null==r||null==(t=r.response)||null==(e=t.data)?void 0:e.message)||"Alt tip bağlama başarısız")}};(0,r.useEffect)(()=>{(async()=>{if(!h)return C([]);try{let e=await i.consumableTypeApi.getByConsumable(h);C(e)}catch(e){console.error(e),C([])}})()},[h]);let I=async(e,t)=>{try{await i.institutionConsumablesApi.delete(e),y(r=>{let a=String(t),i=(r[a]||[]).filter(t=>t.id!==e);return{...r,[a]:i}}),o.toast.success("Bağlantı kaldırıldı")}catch(e){console.error(e),o.toast.error("Bağlantı kaldırma başarısız")}};return(0,t.jsxs)("div",{className:"max-w-5xl mx-auto py-8 space-y-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"Kurumlara Sarf Malzemesi Bağla"}),A?(0,t.jsx)("p",{className:"text-muted-foreground",children:"Yüklüyor..."}):(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{children:(0,t.jsx)(s.CardTitle,{children:"Bağla"})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Kurum"}),(0,t.jsxs)(n.Select,{value:g?String(g):void 0,onValueChange:e=>p(Number(e)),children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Kurum seçin"})}),(0,t.jsx)(n.SelectContent,{children:c.map(e=>(0,t.jsx)(n.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Sarf Malzemesi"}),(0,t.jsxs)(n.Select,{value:h?String(h):void 0,onValueChange:e=>v(Number(e)),children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Sarf malzemesi seçin"})}),(0,t.jsx)(n.SelectContent,{children:m.map(e=>(0,t.jsx)(n.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end mt-4",children:[(0,t.jsxs)("div",{className:"md:col-span-1",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:"Alt Tip"}),(0,t.jsxs)(n.Select,{value:f?String(f):void 0,onValueChange:e=>b(Number(e)),children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Alt tip seçin"})}),(0,t.jsx)(n.SelectContent,{children:w.map(e=>(0,t.jsx)(n.SelectItem,{value:String(e.id),children:e.typeName},e.id))})]})]}),(0,t.jsx)("div",{className:"md:col-span-2",children:(0,t.jsx)(l.Button,{className:"w-full",onClick:z,disabled:!g||!f,children:"Alt Tip Bağla"})})]}),g&&(0,t.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:"Bağlanmış sarf malzemeleri"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:k.length?k.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2 border rounded px-2 py-1",children:[(0,t.jsx)(d.Badge,{variant:"outline",children:e.consumableName}),(0,t.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>I(e.id,e.institutionId),children:"Kaldır"})]},e.id)):(0,t.jsx)("span",{className:"text-muted-foreground",children:"Bağlanmış sarf malzemesi yok"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:"Bağlanmış alt tipler"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:T.length?T.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2 border rounded px-2 py-1",children:[(0,t.jsx)(d.Badge,{variant:"secondary",children:e.typeName}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.consumableName,")"]})]},e.id)):(0,t.jsx)("span",{className:"text-muted-foreground",children:"Bağlanmış alt tip yok"})})]})]})]})]})]})}function u(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{className:"max-w-4xl mx-auto py-8 text-center",children:"Yükleniyor..."}),children:(0,t.jsx)(c,{})})}}]);