(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87486,e=>{"use strict";e.s(["Badge",()=>i]);var s=e.i(43476),t=e.i(91918),r=e.i(25913),l=e.i(75157);let a=(0,r.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:i,asChild:n=!1,...d}=e,o=n?t.Slot:"span";return(0,s.jsx)(o,{"data-slot":"badge",className:(0,l.cn)(a({variant:i}),r),...d})}},75254,e=>{"use strict";e.s(["default",()=>i],75254);var s=e.i(71645);let t=e=>{let s=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase());return s.charAt(0).toUpperCase()+s.slice(1)},r=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:d,className:o="",children:c,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...l,width:i,height:i,stroke:a,strokeWidth:d?24*Number(n)/Number(i):n,className:r("lucide",o),...!c&&!(e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),i=(e,l)=>{let i=(0,s.forwardRef)((i,n)=>{let{className:d,...o}=i;return(0,s.createElement)(a,{ref:n,iconNode:l,className:r("lucide-".concat(t(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),d),...o})});return i.displayName=t(e),i}},15288,e=>{"use strict";e.s(["Card",()=>r,"CardContent",()=>n,"CardDescription",()=>i,"CardHeader",()=>l,"CardTitle",()=>a]);var s=e.i(43476),t=e.i(75157);function r(e){let{className:r,...l}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...l})}function l(e){let{className:r,...l}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...l})}function a(e){let{className:r,...l}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",r),...l})}function i(e){let{className:r,...l}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",r),...l})}function n(e){let{className:r,...l}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",r),...l})}},48425,e=>{"use strict";e.s(["Primitive",()=>a,"dispatchDiscreteCustomEvent",()=>i]);var s=e.i(71645),t=e.i(74080),r=e.i(91918),l=e.i(43476),a=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,r.createSlot)("Primitive.".concat(t)),i=s.forwardRef((e,s)=>{let{asChild:r,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(r?a:t,{...i,ref:s})});return i.displayName="Primitive.".concat(t),{...e,[t]:i}},{});function i(e,s){e&&t.flushSync(()=>e.dispatchEvent(s))}},93479,e=>{"use strict";e.s(["Input",()=>r]);var s=e.i(43476),t=e.i(75157);function r(e){let{className:r,type:l,...a}=e;return(0,s.jsx)("input",{type:l,"data-slot":"input",className:(0,t.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...a})}},37727,e=>{"use strict";e.s(["X",()=>s],37727);let s=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},22190,80712,e=>{"use strict";e.s(["InstitutionDetailsModal",()=>x],22190);var s=e.i(43476),t=e.i(71645),r=e.i(9165),l=e.i(15288),a=e.i(87486);e.s(["ProductDetailsModal",()=>u],80712);var i=e.i(19455),n=e.i(93479),d=e.i(37727),o=e.i(67489),c=e.i(46696);function u(e){var u,m,x,h,g,v;let{isOpen:p,onClose:j,productId:f}=e,[b,y]=(0,t.useState)(!1),[N,k]=(0,t.useState)(null),[S,C]=(0,t.useState)([]),[w,A]=(0,t.useState)(null),[I,B]=(0,t.useState)(null),[M,z]=(0,t.useState)(!1),[T,F]=(0,t.useState)(!1),[D,K]=(0,t.useState)(""),[L,P]=(0,t.useState)([]),[E,U]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(async()=>{if(p&&f)try{var e,s,t;y(!0);let[l,a]=await Promise.all([r.productApi.getProductById(f),r.institutionApi.getAll({page:0,size:1e3,sort:"name"})]),i=Array.isArray(a)?a:Array.isArray(null==a?void 0:a.content)?a.content:[];C(i.map(e=>({id:e.id,name:e.name}))),k(l),A(null!=(e=null==l?void 0:l.institutionId)?e:null),B(null!=(s=null==l?void 0:l.ownerId)?s:null),K(null!=(t=null==l?void 0:l.status)?t:""),V()}catch(e){console.error(e),k(null)}finally{y(!1)}})()},[p,f]);let V=async()=>{if(f)try{U(!0);let e=(await r.cyclesApi.getFiltered({userId:void 0,institutionId:void 0})).filter(e=>e.productId===f).sort((e,s)=>s.year-e.year||s.month-e.month).slice(0,6);P(e)}catch(e){console.error("Failed to load cycles:",e),P([])}finally{U(!1)}};return p&&f?(0,s.jsx)("div",{className:"fixed inset-0 bg-background/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-card text-foreground border rounded-lg shadow-lg max-w-xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-card/95 supports-[backdrop-filter]:bg-card/80 backdrop-blur border-b p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Ürün Detayları"}),(null==N?void 0:N.serial)&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Seri: ",N.serial]})]}),(0,s.jsx)(i.Button,{variant:"ghost",size:"sm",onClick:j,children:(0,s.jsx)(d.X,{className:"h-4 w-4"})})]}),(0,s.jsx)("div",{className:"p-4 space-y-4",children:b?(0,s.jsx)("div",{className:"text-center py-8",children:"Yüklüyor..."}):N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsx)(l.CardTitle,{className:"text-lg",children:"Özet"})}),(0,s.jsxs)(l.CardContent,{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Marka / Model"}),(0,s.jsxs)("div",{className:"font-medium",children:[null!=(u=N.brand)?u:"-"," ",null!=(m=N.model)?m:""]})]}),(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Tip"}),(0,s.jsx)("div",{className:"font-medium",children:null!=(x=N.type)?x:"-"})]}),(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Durum"}),(0,s.jsx)("div",{className:"font-medium",children:T?(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(n.Input,{value:D,onChange:e=>K(e.target.value),maxLength:100,placeholder:"Durum giriniz",className:"h-8"}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground text-right",children:[D.length,"/100 karakter"]})]}):(0,s.jsx)(a.Badge,{variant:"aktif"===N.status?"default":"secondary",children:N.status})})]}),(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Sorumlu"}),(0,s.jsx)("div",{className:"font-medium",children:null!=(h=N.responsibleFullName)?h:"-"})]})]})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsx)(l.CardTitle,{className:"text-lg",children:"Kurum ve Sahip"}),!T&&(0,s.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>F(!0),children:"Düzenle"})]})}),T?(0,s.jsxs)(l.CardContent,{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Kurum"}),(0,s.jsxs)(o.Select,{value:w?String(w):void 0,onValueChange:e=>A(Number(e)),children:[(0,s.jsx)(o.SelectTrigger,{children:(0,s.jsx)(o.SelectValue,{placeholder:N.institutionName||"Kurum seçin"})}),(0,s.jsx)(o.SelectContent,{children:S.map(e=>(0,s.jsx)(o.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Sahip"}),(0,s.jsxs)(o.Select,{value:I?String(I):void 0,onValueChange:e=>B(Number(e)),children:[(0,s.jsx)(o.SelectTrigger,{children:(0,s.jsx)(o.SelectValue,{placeholder:N.ownerName||"Sahip seçin"})}),(0,s.jsx)(o.SelectContent,{children:S.map(e=>(0,s.jsx)(o.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"md:col-span-2 flex items-center gap-2",children:[(0,s.jsx)(i.Button,{className:"flex-1",disabled:M||!w||!I,onClick:async()=>{var e,s,t,l;if(N&&w&&I)try{z(!0),await r.productApi.updateProduct(N.id,{serial:N.serial,type:N.type,brand:N.brand,model:N.model,status:D,institutionId:w,ownerId:I,responsibleId:null!=(e=N.responsibleId)?e:void 0}),c.toast.success("Ürün güncellendi");let t=await r.productApi.getProductById(N.id);k(t),K(null!=(s=null==t?void 0:t.status)?s:""),F(!1)}catch(e){console.error(e),c.toast.error((null==e||null==(l=e.response)||null==(t=l.data)?void 0:t.message)||"Ürün güncelleme başarısız")}finally{z(!1)}},children:M?"Kaydediliyor...":"Değişiklikleri Kaydet"}),(0,s.jsx)(i.Button,{className:"flex-1",variant:"outline",onClick:()=>{var e,s,t;A(null!=(e=null==N?void 0:N.institutionId)?e:null),B(null!=(s=null==N?void 0:N.ownerId)?s:null),K(null!=(t=null==N?void 0:N.status)?t:""),F(!1)},children:"İptal"})]})]}):(0,s.jsxs)(l.CardContent,{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Kurum"}),(0,s.jsx)("div",{className:"font-medium",children:null!=(g=N.institutionName)?g:"-"})]}),(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Sahip"}),(0,s.jsx)("div",{className:"font-medium",children:null!=(v=N.ownerName)?v:"-"})]})]})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsx)(l.CardTitle,{className:"text-lg",children:"Döngü Geçmişi (Son 6 Ay)"})}),(0,s.jsx)(l.CardContent,{children:E?(0,s.jsx)("div",{className:"text-center py-4",children:"Döngüler yüklüyor..."}):0===L.length?(0,s.jsx)("p",{className:"text-muted-foreground",children:"Bu ürün için döngü verisi bulunamadı."}):(0,s.jsx)("div",{className:"space-y-2",children:L.map((e,t)=>{let r=L[t+1],l=r?e.cycleCount-r.cycleCount:null,a=null===l?"text-muted-foreground":l>=0?"text-green-600":"text-red-600";return(0,s.jsxs)("div",{className:"border rounded-md px-3 py-2 bg-muted/50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"text-sm font-medium",children:[e.year,"-",String(e.month).padStart(2,"0")]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:new Date(e.year,e.month-1).toLocaleString("default",{month:"long",year:"numeric"})})]}),(0,s.jsxs)("div",{className:"text-sm font-medium",children:[e.cycleCount.toLocaleString()," döngü"]})]}),null!==l&&(0,s.jsx)("div",{className:"mt-1 text-right",children:(0,s.jsxs)("span",{className:"text-xs ".concat(a),children:["Kullanım: ",l>=0?"+".concat(l.toLocaleString()):l.toLocaleString()]})})]},e.id)})})})]})]}):(0,s.jsx)("div",{className:"text-muted-foreground",children:"Ürün bulunamadı."})})]})}):null}var m=e.i(18566);function x(e){let{isOpen:n,onClose:o,institutionId:x,institutionName:h,institutionCity:g}=e,[v,p]=(0,t.useState)([]),[j,f]=(0,t.useState)([]),[b,y]=(0,t.useState)(!1),[N,k]=(0,t.useState)(!1),[S,C]=(0,t.useState)(null);(0,m.useRouter)(),(0,t.useEffect)(()=>{n&&x&&w()},[n,x]);let w=async()=>{try{y(!0),console.log("Loading data for institution ID:",x),console.log("Auth token:",localStorage.getItem("authToken"));let[e,s]=await Promise.all([r.productApi.getProductsByInstitution(x),r.institutionConsumableTypeApi.getByInstitution(x)]);console.log("Products response:",e),console.log("Types response:",s),p(e),f(s)}catch(a){var e,s,t,l;console.error("Failed to load institution data:",a),console.error("Error details:",null==a||null==(e=a.response)?void 0:e.data),console.error("Error status:",null==a||null==(s=a.response)?void 0:s.status),console.error("Error message:",null==a?void 0:a.message);let r=(null==a||null==(t=a.response)?void 0:t.status)===401?"Kimlik doğrulama gerekli. Lütfen tekrar giriş yapın.":(null==a||null==(l=a.response)?void 0:l.status)===403?"Erişim engellendi. Bu verileri görüntüleme izniniz yok.":(null==a?void 0:a.message)||"Kurum verileri yüklenemedi";c.toast.error(r)}finally{y(!1)}};return n?(0,s.jsx)("div",{className:"fixed inset-0 bg-background/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-card text-foreground border rounded-lg shadow-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-card/95 supports-[backdrop-filter]:bg-card/80 backdrop-blur border-b p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:h}),g&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:g})]}),(0,s.jsx)(i.Button,{variant:"ghost",size:"sm",onClick:o,children:(0,s.jsx)(d.X,{className:"h-4 w-4"})})]}),(0,s.jsx)("div",{className:"p-4 space-y-6",children:b?(0,s.jsx)("div",{className:"text-center py-8",children:"Yüklüyor..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)(l.CardTitle,{className:"text-lg",children:["Ürünler (",v.length,")"]})}),(0,s.jsx)(l.CardContent,{children:v.length>0?(0,s.jsx)("div",{className:"space-y-2",children:v.map(e=>(0,s.jsx)("button",{className:"w-full text-left border rounded-md p-3 bg-muted/50 hover:bg-muted transition",onClick:()=>{C(e.id),k(!0)},children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium",children:[e.brand," ",e.model," - ",e.serial]}),e.type&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Tip: ",e.type]}),e.responsibleFullName&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Sorumlu: ",e.responsibleFullName]})]}),(0,s.jsx)(a.Badge,{variant:"aktif"===e.status?"default":"secondary",children:e.status})]})},e.id))}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"Bu kurum için ürün bulunamadı."})})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)(l.CardTitle,{className:"text-lg",children:["Bağlanmış Sarf Malzemesi Tipleri (",j.length,")"]})}),(0,s.jsx)(l.CardContent,{children:j.length>0?(0,s.jsx)("div",{className:"space-y-2",children:j.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2 border rounded-md px-3 py-2 bg-muted/50",children:[(0,s.jsx)(a.Badge,{variant:"secondary",children:e.typeName}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",e.consumableName,")"]})]},e.id))}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"Bu kuruma bağlanmış sarf malzemesi tipi yok."})})]})]})}),(0,s.jsx)(u,{isOpen:N,onClose:()=>{k(!1),C(null)},productId:S})]})}):null}},88511,e=>{"use strict";e.s(["Edit",()=>s],88511);let s=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},88844,e=>{"use strict";e.s(["Package",()=>s],88844);let s=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},55436,e=>{"use strict";e.s(["Search",()=>s],55436);let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},61911,e=>{"use strict";e.s(["Users",()=>s],61911);let s=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},7486,38982,e=>{"use strict";e.s(["Building2",()=>t],7486);var s=e.i(75254);let t=(0,s.default)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["FlaskConical",()=>r],38982);let r=(0,s.default)("flask-conical",[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]])},12336,e=>{"use strict";e.s(["default",()=>j]);var s=e.i(43476),t=e.i(71645),r=e.i(9165),l=e.i(15288),a=e.i(93479),i=e.i(19455),n=e.i(67489),d=e.i(87486),o=e.i(80712),c=e.i(22190),u=e.i(46696),m=e.i(55436),x=e.i(61911),h=e.i(7486),g=e.i(88844),v=e.i(88511),p=e.i(38982);function j(){let[e,j]=(0,t.useState)(!0),[f,b]=(0,t.useState)([]),[y,N]=(0,t.useState)(""),[k,S]=(0,t.useState)("all"),[C,w]=(0,t.useState)("all"),[A,I]=(0,t.useState)("serial"),[B,M]=(0,t.useState)("asc"),[z,T]=(0,t.useState)(null),[F,D]=(0,t.useState)(!1),[K,L]=(0,t.useState)(null),[P,E]=(0,t.useState)(!1),U=async()=>{try{j(!0);let e=await r.productApi.getProducts(),s=Array.isArray(e)?e:[],t=[];for(let e of s)try{let s=await r.userAssignmentsApi.getAssignmentsByProduct(e.id),l=[];if(e.institutionId)try{l=await r.institutionConsumablesApi.getByInstitution(e.institutionId)}catch(s){console.error("Failed to load consumables for institution ".concat(e.institutionId,":"),s)}t.push({...e,assignedUsers:Array.isArray(s)?s:[],linkedConsumables:Array.isArray(l)?l:[]})}catch(s){console.error("Failed to load details for product ".concat(e.id,":"),s),t.push({...e,assignedUsers:[],linkedConsumables:[]})}b(t)}catch(e){console.error("Failed to load products:",e),u.toast.error("Ürünler yüklenirken hata oluştu")}finally{j(!1)}};(0,t.useEffect)(()=>{U()},[]);let V=(0,t.useMemo)(()=>{let e=new Set;return f.forEach(s=>{s.institutionName&&e.add(s.institutionName)}),Array.from(e).sort()},[f]),H=(0,t.useMemo)(()=>{let e=new Set;return f.forEach(s=>{s.status&&e.add(s.status)}),Array.from(e).sort()},[f]),q=(0,t.useMemo)(()=>{let e=f.filter(e=>{var s,t,r,l,a,i;let n=y.toLowerCase(),d=!y||(null==(s=e.serial)?void 0:s.toLowerCase().includes(n))||(null==(t=e.brand)?void 0:t.toLowerCase().includes(n))||(null==(r=e.model)?void 0:r.toLowerCase().includes(n))||(null==(l=e.type)?void 0:l.toLowerCase().includes(n))||(null==(a=e.institutionName)?void 0:a.toLowerCase().includes(n))||(null==(i=e.responsibleFullName)?void 0:i.toLowerCase().includes(n)),o="all"===k||e.status===k,c="all"===C||e.institutionName===C;return d&&o&&c});return e.sort((e,s)=>{let t="",r="";switch(A){case"serial":default:t=e.serial||"",r=s.serial||"";break;case"brand":t=e.brand||"",r=s.brand||"";break;case"model":t=e.model||"",r=s.model||"";break;case"status":t=e.status||"",r=s.status||"";break;case"institution":t=e.institutionName||"",r=s.institutionName||"";break;case"responsible":t=e.responsibleFullName||"",r=s.responsibleFullName||"";break;case"assignedUsers":t=e.assignedUsers.length,r=s.assignedUsers.length}if("string"==typeof t&&"string"==typeof r){let e=t.localeCompare(r);return"asc"===B?e:-e}{let e=t-r;return"asc"===B?e:-e}}),e},[f,y,k,C,A,B]),O=e=>{T(e),D(!0)};return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto py-8 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Ürünler"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[q.length," ürün"]}),(0,s.jsxs)(i.Button,{onClick:()=>window.location.href="/products/add",className:"ml-4",children:[(0,s.jsx)(g.Package,{className:"h-4 w-4 mr-2"}),"Ürün Ekle"]})]})]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsx)(l.CardTitle,{className:"text-lg",children:"Filtreler ve Arama"})}),(0,s.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(a.Input,{placeholder:"Ürün ara (seri, marka, model, tip, kurum, sorumlu)...",value:y,onChange:e=>N(e.target.value),className:"pl-10"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Durum"}),(0,s.jsxs)(n.Select,{value:k,onValueChange:S,children:[(0,s.jsx)(n.SelectTrigger,{children:(0,s.jsx)(n.SelectValue,{placeholder:"Durum seçin"})}),(0,s.jsxs)(n.SelectContent,{children:[(0,s.jsx)(n.SelectItem,{value:"all",children:"Tümü"}),H.map(e=>(0,s.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Kurum"}),(0,s.jsxs)(n.Select,{value:C,onValueChange:w,children:[(0,s.jsx)(n.SelectTrigger,{children:(0,s.jsx)(n.SelectValue,{placeholder:"Kurum seçin"})}),(0,s.jsxs)(n.SelectContent,{children:[(0,s.jsx)(n.SelectItem,{value:"all",children:"Tümü"}),V.map(e=>(0,s.jsx)(n.SelectItem,{value:e,children:e},e))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Sırala"}),(0,s.jsxs)(n.Select,{value:A,onValueChange:I,children:[(0,s.jsx)(n.SelectTrigger,{children:(0,s.jsx)(n.SelectValue,{placeholder:"Sıralama kriteri"})}),(0,s.jsxs)(n.SelectContent,{children:[(0,s.jsx)(n.SelectItem,{value:"serial",children:"Seri Numarası"}),(0,s.jsx)(n.SelectItem,{value:"brand",children:"Marka"}),(0,s.jsx)(n.SelectItem,{value:"model",children:"Model"}),(0,s.jsx)(n.SelectItem,{value:"status",children:"Durum"}),(0,s.jsx)(n.SelectItem,{value:"institution",children:"Kurum"}),(0,s.jsx)(n.SelectItem,{value:"responsible",children:"Sorumlu"}),(0,s.jsx)(n.SelectItem,{value:"assignedUsers",children:"Atanan Kullanıcı Sayısı"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Sıra"}),(0,s.jsxs)(n.Select,{value:B,onValueChange:e=>M(e),children:[(0,s.jsx)(n.SelectTrigger,{children:(0,s.jsx)(n.SelectValue,{placeholder:"Sıra"})}),(0,s.jsxs)(n.SelectContent,{children:[(0,s.jsx)(n.SelectItem,{value:"asc",children:"Artan"}),(0,s.jsx)(n.SelectItem,{value:"desc",children:"Azalan"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium opacity-0",children:"."}),(0,s.jsx)(i.Button,{variant:"outline",className:"w-full",onClick:()=>{N(""),S("all"),w("all"),I("serial"),M("asc")},children:"Filtreleri Temizle"})]})]})]})]}),e?(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("div",{className:"text-muted-foreground",children:"Ürünler yükleniyor..."})}):0===q.length?(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("div",{className:"text-muted-foreground",children:y||"all"!==k||"all"!==C?"Filtrelere uygun ürün bulunamadı.":"Henüz ürün eklenmemiş."})}):(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:q.map(e=>(0,s.jsxs)(l.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)(l.CardTitle,{className:"flex items-center justify-between",children:[(0,s.jsxs)("button",{onClick:()=>O(e.id),className:"text-lg font-semibold text-foreground hover:text-blue-600 hover:underline cursor-pointer text-left",children:[e.brand," ",e.model]}),(0,s.jsxs)(i.Button,{size:"sm",variant:"outline",onClick:()=>O(e.id),children:[(0,s.jsx)(v.Edit,{className:"h-4 w-4 mr-1"}),"Düzenle"]})]})}),(0,s.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Seri Numarası"}),(0,s.jsx)("div",{className:"font-medium",children:e.serial})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Tip"}),(0,s.jsx)("div",{className:"font-medium",children:e.type||"-"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Durum"}),(0,s.jsx)(d.Badge,{variant:"Çalışıyor"===e.status?"default":"secondary",children:e.status})]}),e.institutionName&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Kurum"}),(0,s.jsxs)("button",{onClick:()=>{var s,t;return s=e.institutionId,t=e.institutionName,void(s&&t&&(L({id:s,name:t}),E(!0)))},className:"font-medium hover:text-blue-600 hover:underline cursor-pointer",children:[(0,s.jsx)(h.Building2,{className:"inline h-4 w-4 mr-1"}),e.institutionName]})]}),e.responsibleFullName&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Sorumlu"}),(0,s.jsx)("div",{className:"font-medium",children:e.responsibleFullName})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mb-1",children:["Atanan Kullanıcılar (",e.assignedUsers.length,")"]}),e.assignedUsers.length>0?(0,s.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.assignedUsers.slice(0,3).map(e=>(0,s.jsxs)(d.Badge,{variant:"outline",children:[(0,s.jsx)(x.Users,{className:"h-3 w-3 mr-1"}),e.username]},e.id)),e.assignedUsers.length>3&&(0,s.jsxs)(d.Badge,{variant:"outline",children:["+",e.assignedUsers.length-3," daha"]})]}):(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Atanan kullanıcı yok"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mb-1",children:["Kurum Sarf Malzemeleri (",e.linkedConsumables.length,")"]}),e.linkedConsumables.length>0?(0,s.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.linkedConsumables.slice(0,2).map((e,t)=>(0,s.jsxs)(d.Badge,{variant:"outline",children:[(0,s.jsx)(p.FlaskConical,{className:"h-3 w-3 mr-1"}),e.consumableName||"Sarf Malzemesi"]},t)),e.linkedConsumables.length>2&&(0,s.jsxs)(d.Badge,{variant:"outline",children:["+",e.linkedConsumables.length-2," daha"]})]}):(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Bağlı sarf malzemesi yok"})]})]})]},e.id))}),(0,s.jsx)(o.ProductDetailsModal,{isOpen:F,onClose:()=>{D(!1),T(null),U()},productId:z}),K&&(0,s.jsx)(c.InstitutionDetailsModal,{isOpen:P,onClose:()=>{E(!1),L(null)},institutionId:K.id,institutionName:K.name,institutionCity:K.city})]})}}]);